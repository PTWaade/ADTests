<!DOCTYPE html>
<html>
<head><title>Turing AD tests</title>
<link rel="stylesheet" type="text/css" href="main.css">
</head>
<body><main>
<h1>Turing AD tests</h1>

<p><a href="https://turinglang.org/docs">Turing.jl documentation</a> | <a href="https://github.com/TuringLang/Turing.jl">Turing.jl GitHub</a> | <a href="https://github.com/TuringLang/ADTests">Source code for these tests</a></p>

<p>This page is intended as a brief overview of how different AD backends
perform on a variety of Turing.jl models.
Note that the inclusion of any AD backend here does not imply an endorsement
from the Turing team; this table is purely for information.
</p>

<ul>
<li>The definitions of the models and AD types below can be found on <a
href="https://github.com/TuringLang/ADTests" target="_blank">GitHub</a>.</li>
<li><b>Numbers</b> indicate the time taken to calculate the gradient of the log
density of the model using the specified AD type, divided by the time taken to
calculate the log density itself (in AD speak, the primal). Basically:
<b>smaller means faster.</b></li>
<li>'<span class="wrong">wrong</span>' means that AD ran but the result was not
correct. If this happens you should be very wary! Note that this is done by
comparing against the result obtained using ForwardDiff, i.e., ForwardDiff is
by definition always 'correct'.</li>
<li>'<span class="error">error</span>' means that AD didn't run.</li>
<li>Some of the 'wrong' or 'error' entries have question marks next to them.
These will link to a GitHub issue or other page that describes the problem.
</ul>

<h2>Results</h2>
<table id="results"><thead><tr><th class="right">Model name \ AD type</th><th class="right">EnzymeForward</th><th class="right">EnzymeReverse</th><th class="right">FiniteDifferences</th><th class="right">ForwardDiff</th><th class="right">Mooncake</th><th class="right">ReverseDiff</th><th class="right">ReverseDiffCompiled</th><th class="right">Zygote</th></tr></thead><tbody>
<tr><td>assume_beta</td><td>2.619</td><td>4.169</td><td>23.478</td><td>1.730</td><td>7.041</td><td>29.383</td><td>2.836</td><td>750.941</td></tr>
<tr><td>assume_dirichlet</td><td>2.379</td><td>3.659</td><td>23.901</td><td>1.317</td><td>8.822</td><td>15.973</td><td>3.069</td><td>615.942</td></tr>
<tr><td>assume_lkjcholu</td><td>4.645</td><td>13.086</td><td>151.029</td><td>2.457</td><td>7.055</td><td>52.771</td><td>7.421</td><td><span class="error">error</td></tr>
<tr><td>assume_mvnormal</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>3.732</td><td>43.165</td><td>1.312</td><td>8.939</td><td>17.261</td><td>2.007</td><td>665.223</td></tr>
<tr><td>assume_normal</td><td>2.791</td><td>3.187</td><td>28.101</td><td>1.504</td><td>9.696</td><td>21.382</td><td>1.091</td><td>1144.677</td></tr>
<tr><td>assume_submodel</td><td>2.226</td><td>2.094</td><td>34.558</td><td>1.211</td><td>6.936</td><td>14.380</td><td>1.369</td><td>1156.525</td></tr>
<tr><td>assume_wishart</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>14.766</td><td>44.699</td><td>1.082</td><td>10.349</td><td>19.550</td><td>4.180</td><td>258.890</td></tr>
<tr><td>control_flow</td><td>2.647</td><td>3.276</td><td>41.035</td><td>2.205</td><td>9.539</td><td>20.910</td><td><span class="wrong">wrong</td><td>1115.808</td></tr>
<tr><td>dot_assume</td><td>2.876</td><td>2.221</td><td>76.921</td><td>1.390</td><td>5.396</td><td>21.467</td><td>2.389</td><td><span class="error">error</td></tr>
<tr><td>dot_assume_observe_index</td><td><span class="wrong">wrong</td><td><span class="wrong">wrong</td><td>52.139</td><td>1.391</td><td>5.814</td><td>35.967</td><td>3.556</td><td><span class="error">error</td></tr>
<tr><td>dot_observe</td><td>2.770</td><td>2.439</td><td>27.885</td><td>1.676</td><td>9.306</td><td>57.341</td><td>6.050</td><td><span class="error">error</td></tr>
<tr><td>dynamic_constraint</td><td>2.406</td><td>2.451</td><td>35.982</td><td>1.315</td><td>8.367</td><td>33.243</td><td>1.736</td><td>1207.006</td></tr>
<tr><td>multiple_constraints_same_var</td><td>4.993</td><td>26.799</td><td>59.303</td><td>1.202</td><td>13.269</td><td>21.035</td><td>2.172</td><td><span class="error">error</td></tr>
<tr><td>multithreaded</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td><td><span class="error">error</td></tr>
<tr><td>n010</td><td>4.221</td><td>2.109</td><td>142.054</td><td>1.698</td><td>4.600</td><td>24.234</td><td>2.376</td><td><span class="error">error</td></tr>
<tr><td>n050</td><td>20.654</td><td>2.293</td><td>626.755</td><td>8.628</td><td>4.027</td><td>25.705</td><td>2.435</td><td><span class="error">error</td></tr>
<tr><td>n100</td><td>39.868</td><td>2.130</td><td>1238.669</td><td>13.808</td><td>3.869</td><td>25.966</td><td>2.502</td><td><span class="error">error</td></tr>
<tr><td>n500</td><td>173.118</td><td>2.548</td><td>6456.033</td><td>56.842</td><td>3.861</td><td>23.416</td><td>2.263</td><td><span class="error">error</td></tr>
<tr><td>observe_index</td><td>2.728</td><td>2.609</td><td>28.454</td><td>1.699</td><td>9.795</td><td>55.510</td><td>5.036</td><td><span class="error">error</td></tr>
<tr><td>observe_literal</td><td>2.756</td><td>3.168</td><td>27.952</td><td>1.514</td><td>9.082</td><td>34.162</td><td>3.366</td><td>1474.322</td></tr>
<tr><td>observe_multivariate</td><td>2.826</td><td>4.047</td><td>50.875</td><td>1.438</td><td>7.027</td><td>28.038</td><td>2.741</td><td><span class="error">error</td></tr>
<tr><td>observe_submodel</td><td>2.377</td><td>2.251</td><td>23.641</td><td>1.503</td><td>7.642</td><td>26.522</td><td>2.754</td><td>2189.607</td></tr>
</tbody></table><h2>Manifest</h2><p>The tests above were run with the following package versions:</p><table id='manifest'><thead><tr><th>Package</th><th>Version</th><tr><td>ADTypes</td><td>v1.14.0</td></tr><tr><td>AbstractFFTs</td><td>v1.5.0</td></tr><tr><td>AbstractMCMC</td><td>v5.6.0</td></tr><tr><td>AbstractPPL</td><td>v0.11.0</td></tr><tr><td>AbstractTrees</td><td>v0.4.5</td></tr><tr><td>Accessors</td><td>v0.1.42</td></tr><tr><td>Adapt</td><td>v4.3.0</td></tr><tr><td>AliasTables</td><td>v1.1.3</td></tr><tr><td>ArgCheck</td><td>v2.5.0</td></tr><tr><td>ArgTools</td><td>v1.1.2</td></tr><tr><td>ArnoldiMethod</td><td>v0.4.0</td></tr><tr><td>Artifacts</td><td>v1.11.0</td></tr><tr><td>BangBang</td><td>v0.4.4</td></tr><tr><td>Base64</td><td>v1.11.0</td></tr><tr><td>Baselet</td><td>v0.1.1</td></tr><tr><td>Bijectors</td><td>v0.15.6</td></tr><tr><td>CEnum</td><td>v0.5.0</td></tr><tr><td>ChainRules</td><td>v1.72.3</td></tr><tr><td>ChainRulesCore</td><td>v1.25.1</td></tr><tr><td>Chairmarks</td><td>v1.3.1</td></tr><tr><td>ChangesOfVariables</td><td>v0.1.10</td></tr><tr><td>CommonSolve</td><td>v0.2.4</td></tr><tr><td>CommonSubexpressions</td><td>v0.3.1</td></tr><tr><td>Compat</td><td>v4.16.0</td></tr><tr><td>CompilerSupportLibraries_jll</td><td>v1.1.1+0</td></tr><tr><td>CompositionsBase</td><td>v0.1.2</td></tr><tr><td>ConsoleProgressMonitor</td><td>v0.1.2</td></tr><tr><td>ConstructionBase</td><td>v1.5.8</td></tr><tr><td>DataAPI</td><td>v1.16.0</td></tr><tr><td>DataStructures</td><td>v0.18.22</td></tr><tr><td>DataValueInterfaces</td><td>v1.0.0</td></tr><tr><td>Dates</td><td>v1.11.0</td></tr><tr><td>DefineSingletons</td><td>v0.1.2</td></tr><tr><td>DensityInterface</td><td>v0.4.0</td></tr><tr><td>DiffResults</td><td>v1.1.0</td></tr><tr><td>DiffRules</td><td>v1.15.1</td></tr><tr><td>DifferentiationInterface</td><td>v0.6.52</td></tr><tr><td>Distributed</td><td>v1.11.0</td></tr><tr><td>Distributions</td><td>v0.25.119</td></tr><tr><td>DocStringExtensions</td><td>v0.9.4</td></tr><tr><td>Downloads</td><td>v1.6.0</td></tr><tr><td>DynamicPPL</td><td>v0.36.1</td></tr><tr><td>Enzyme</td><td>v0.13.41</td></tr><tr><td>EnzymeCore</td><td>v0.8.8</td></tr><tr><td>Enzyme_jll</td><td>v0.0.175+0</td></tr><tr><td>ExprTools</td><td>v0.1.10</td></tr><tr><td>FileWatching</td><td>v1.11.0</td></tr><tr><td>FillArrays</td><td>v1.13.0</td></tr><tr><td>FiniteDifferences</td><td>v0.12.32</td></tr><tr><td>ForwardDiff</td><td>v0.10.38</td></tr><tr><td>FunctionWrappers</td><td>v1.1.3</td></tr><tr><td>Functors</td><td>v0.5.2</td></tr><tr><td>Future</td><td>v1.11.0</td></tr><tr><td>GPUArraysCore</td><td>v0.2.0</td></tr><tr><td>GPUCompiler</td><td>v1.4.0</td></tr><tr><td>Graphs</td><td>v1.12.1</td></tr><tr><td>HypergeometricFunctions</td><td>v0.3.28</td></tr><tr><td>IRTools</td><td>v0.4.14</td></tr><tr><td>Inflate</td><td>v0.1.5</td></tr><tr><td>InitialValues</td><td>v0.3.1</td></tr><tr><td>InteractiveUtils</td><td>v1.11.0</td></tr><tr><td>InverseFunctions</td><td>v0.1.17</td></tr><tr><td>IrrationalConstants</td><td>v0.2.4</td></tr><tr><td>IteratorInterfaceExtensions</td><td>v1.0.0</td></tr><tr><td>JLLWrappers</td><td>v1.7.0</td></tr><tr><td>JSON</td><td>v0.21.4</td></tr><tr><td>LLVM</td><td>v9.3.1</td></tr><tr><td>LLVMExtra_jll</td><td>v0.0.35+0</td></tr><tr><td>LazyArtifacts</td><td>v1.11.0</td></tr><tr><td>LeftChildRightSiblingTrees</td><td>v0.2.0</td></tr><tr><td>LibCURL</td><td>v0.6.4</td></tr><tr><td>LibCURL_jll</td><td>v8.6.0+0</td></tr><tr><td>LibGit2</td><td>v1.11.0</td></tr><tr><td>LibGit2_jll</td><td>v1.7.2+0</td></tr><tr><td>LibSSH2_jll</td><td>v1.11.0+1</td></tr><tr><td>LibTracyClient_jll</td><td>v0.9.1+6</td></tr><tr><td>Libdl</td><td>v1.11.0</td></tr><tr><td>LinearAlgebra</td><td>v1.11.0</td></tr><tr><td>LogDensityProblems</td><td>v2.1.2</td></tr><tr><td>LogExpFunctions</td><td>v0.3.29</td></tr><tr><td>Logging</td><td>v1.11.0</td></tr><tr><td>LoggingExtras</td><td>v1.1.0</td></tr><tr><td>MacroTools</td><td>v0.5.16</td></tr><tr><td>MappedArrays</td><td>v0.4.2</td></tr><tr><td>Markdown</td><td>v1.11.0</td></tr><tr><td>MbedTLS_jll</td><td>v2.28.6+0</td></tr><tr><td>MicroCollections</td><td>v0.2.0</td></tr><tr><td>Missings</td><td>v1.2.0</td></tr><tr><td>MistyClosures</td><td>v2.0.0</td></tr><tr><td>Mmap</td><td>v1.11.0</td></tr><tr><td>Mooncake</td><td>v0.4.118</td></tr><tr><td>MozillaCACerts_jll</td><td>v2023.12.12</td></tr><tr><td>NaNMath</td><td>v1.1.3</td></tr><tr><td>NetworkOptions</td><td>v1.2.0</td></tr><tr><td>ObjectFile</td><td>v0.4.4</td></tr><tr><td>OpenBLAS_jll</td><td>v0.3.27+1</td></tr><tr><td>OpenLibm_jll</td><td>v0.8.5+0</td></tr><tr><td>OpenSpecFun_jll</td><td>v0.5.6+0</td></tr><tr><td>OrderedCollections</td><td>v1.8.0</td></tr><tr><td>PDMats</td><td>v0.11.34</td></tr><tr><td>Parsers</td><td>v2.8.3</td></tr><tr><td>Pkg</td><td>v1.11.0</td></tr><tr><td>PrecompileTools</td><td>v1.2.1</td></tr><tr><td>Preferences</td><td>v1.4.3</td></tr><tr><td>Printf</td><td>v1.11.0</td></tr><tr><td>ProgressLogging</td><td>v0.1.4</td></tr><tr><td>ProgressMeter</td><td>v1.10.4</td></tr><tr><td>PtrArrays</td><td>v1.3.0</td></tr><tr><td>QuadGK</td><td>v2.11.2</td></tr><tr><td>Random</td><td>v1.11.0</td></tr><tr><td>RealDot</td><td>v0.1.0</td></tr><tr><td>Reexport</td><td>v1.2.2</td></tr><tr><td>Requires</td><td>v1.3.1</td></tr><tr><td>ReverseDiff</td><td>v1.16.1</td></tr><tr><td>Richardson</td><td>v1.4.2</td></tr><tr><td>Rmath</td><td>v0.8.0</td></tr><tr><td>Rmath_jll</td><td>v0.5.1+0</td></tr><tr><td>Roots</td><td>v2.2.7</td></tr><tr><td>SHA</td><td>v0.7.0</td></tr><tr><td>Scratch</td><td>v1.2.1</td></tr><tr><td>Serialization</td><td>v1.11.0</td></tr><tr><td>Setfield</td><td>v1.1.2</td></tr><tr><td>SharedArrays</td><td>v1.11.0</td></tr><tr><td>SimpleTraits</td><td>v0.9.4</td></tr><tr><td>Sockets</td><td>v1.11.0</td></tr><tr><td>SortingAlgorithms</td><td>v1.2.1</td></tr><tr><td>SparseArrays</td><td>v1.11.0</td></tr><tr><td>SparseInverseSubset</td><td>v0.1.2</td></tr><tr><td>SpecialFunctions</td><td>v2.5.1</td></tr><tr><td>SplittablesBase</td><td>v0.1.15</td></tr><tr><td>StaticArrays</td><td>v1.9.13</td></tr><tr><td>StaticArraysCore</td><td>v1.4.3</td></tr><tr><td>Statistics</td><td>v1.11.1</td></tr><tr><td>StatsAPI</td><td>v1.7.0</td></tr><tr><td>StatsBase</td><td>v0.34.5</td></tr><tr><td>StatsFuns</td><td>v1.5.0</td></tr><tr><td>StructArrays</td><td>v0.7.1</td></tr><tr><td>StructIO</td><td>v0.3.1</td></tr><tr><td>SuiteSparse</td><td></td></tr><tr><td>SuiteSparse_jll</td><td>v7.7.0+0</td></tr><tr><td>TOML</td><td>v1.0.3</td></tr><tr><td>TableTraits</td><td>v1.0.1</td></tr><tr><td>Tables</td><td>v1.12.0</td></tr><tr><td>Tar</td><td>v1.10.0</td></tr><tr><td>TerminalLoggers</td><td>v0.1.7</td></tr><tr><td>Test</td><td>v1.11.0</td></tr><tr><td>Tracy</td><td>v0.1.4</td></tr><tr><td>Transducers</td><td>v0.4.84</td></tr><tr><td>UUIDs</td><td>v1.11.0</td></tr><tr><td>Unicode</td><td>v1.11.0</td></tr><tr><td>Zlib_jll</td><td>v1.2.13+1</td></tr><tr><td>Zygote</td><td>v0.7.7</td></tr><tr><td>ZygoteRules</td><td>v0.2.7</td></tr><tr><td>libblastrampoline_jll</td><td>v5.11.0+0</td></tr><tr><td>nghttp2_jll</td><td>v1.59.0+0</td></tr><tr><td>p7zip_jll</td><td>v17.4.0+2</td></tr></table></main></body></html>