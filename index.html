<!DOCTYPE html>
<html>
<head><title>Turing AD tests</title>
<link rel="stylesheet" type="text/css" href="main.css">
</head>
<body><main>
<h1>Turing AD tests</h1>

<p><a href="https://turinglang.org/docs">Turing.jl documentation</a> | <a href="https://github.com/TuringLang/Turing.jl">Turing.jl GitHub</a> | <a href="https://github.com/TuringLang/ADTests">Source code for these tests</a></p>

<p>This page is intended as a brief overview of how different AD backends
perform on a variety of Turing.jl models.
Note that the inclusion of any AD backend here does not imply an endorsement
from the Turing team; this table is purely for information.
</p>

<ul>
<li>The definitions of the models and AD types below can be found on <a
href="https://github.com/TuringLang/ADTests" target="_blank">GitHub</a>.</li>
<li><b>Numbers</b> indicate the time taken to calculate the gradient of the log
density of the model using the specified AD type, divided by the time taken to
calculate the log density itself (in AD speak, the primal). Basically:
<b>smaller means faster.</b></li>
<li>'<span class="wrong">wrong</span>' means that AD ran but the result was not
correct. If this happens you should be very wary! Note that this is done by
comparing against the result obtained using ForwardDiff, i.e., ForwardDiff is
by definition always 'correct'.</li>
<li>'<span class="error">error</span>' means that AD didn't run.</li>
<li>Some of the 'wrong' or 'error' entries have question marks next to them.
These will link to a GitHub issue or other page that describes the problem.
</ul>

<h2>Results</h2>

<p>(New: You can also hover over the model names to see their definitions.)</p>
<table id="results"><thead><tr><th class="right">Model name \ AD type</th><th class="right">EnzymeForward</th><th class="right">EnzymeReverse</th><th class="right">FiniteDifferences</th><th class="right">ForwardDiff</th><th class="right">Mooncake</th><th class="right">ReverseDiff</th><th class="right">ReverseDiffCompiled</th><th class="right">Zygote</th></tr></thead><tbody>
<tr><td>assume_beta<div class="model-definition"><pre>@model function assume_beta()<br>    a ~ Beta(2, 2)<br>end</pre></div></td><td>2.674</td><td>4.253</td><td>23.750</td><td>1.697</td><td>7.402</td><td>29.957</td><td>2.826</td><td>907.133</td></tr>
<tr><td>assume_dirichlet<div class="model-definition"><pre>@model function assume_dirichlet()<br>    a ~ Dirichlet([1.0, 5.0])<br>end</pre></div></td><td>2.512</td><td>3.295</td><td>23.015</td><td>1.388</td><td>8.394</td><td>13.751</td><td>2.518</td><td>483.471</td></tr>
<tr><td>assume_lkjcholu<div class="model-definition"><pre>@model function assume_lkjcholu()<br>    a ~ LKJCholesky(5, 1.0, 'U')<br>end</pre></div></td><td>4.439</td><td>12.430</td><td>151.570</td><td>2.400</td><td>6.265</td><td>53.971</td><td>6.263</td><td><span class="error">error</td></tr>
<tr><td>assume_mvnormal<div class="model-definition"><pre>@model function assume_mvnormal()<br>    a ~ MvNormal([0.0, 0.0], [1.0 0.5; 0.5 1.0])<br>end</pre></div></td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>5.436</td><td>37.874</td><td>1.196</td><td>11.532</td><td>11.790</td><td>1.228</td><td>558.020</td></tr>
<tr><td>assume_normal<div class="model-definition"><pre>@model function assume_normal()<br>    a ~ Normal()<br>end</pre></div></td><td>2.920</td><td>3.170</td><td>27.789</td><td>1.479</td><td>8.413</td><td>21.178</td><td>2.387</td><td>1157.322</td></tr>
<tr><td>assume_submodel<div class="model-definition"><pre>@model function inner1()<br>    return a ~ Normal()<br>end<br>@model function assume_submodel()<br>    a ~ to_submodel(inner1())<br>    x ~ Normal(a)<br>end</pre></div></td><td>2.200</td><td>2.085</td><td>34.902</td><td>1.239</td><td>6.695</td><td>14.051</td><td>1.402</td><td>1210.983</td></tr>
<tr><td>assume_wishart<div class="model-definition"><pre>@model function assume_wishart()<br>    a ~ Wishart(7, [1.0 0.5; 0.5 1.0])<br>end</pre></div></td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>12.419</td><td>43.542</td><td>1.071</td><td>11.640</td><td>16.519</td><td>3.481</td><td><span class="error">error</td></tr>
<tr><td>control_flow<div class="model-definition"><pre>@model function control_flow()<br>    a ~ Normal()<br>    if a > 0<br>        b ~ Normal()<br>    else<br>        b ~ Beta(2, 2)<br>    end<br>end</pre></div></td><td>2.656</td><td>3.299</td><td>40.997</td><td>1.772</td><td>9.411</td><td>21.532</td><td><span class="wrong">wrong</td><td>1111.116</td></tr>
<tr><td>dot_assume<div class="model-definition"><pre>@model function dot_assume(::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, 5)<br>    a .~ Normal()<br>end</pre></div></td><td>2.873</td><td>2.298</td><td>77.041</td><td>1.379</td><td>5.156</td><td>25.242</td><td>2.545</td><td><span class="error">error</td></tr>
<tr><td>dot_assume_observe_index<div class="model-definition"><pre>@model function dot_assume_observe_index(x=[1.5, 2.0, 2.5], ::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, length(x))<br>    a .~ Normal()<br>    for i in eachindex(x)<br>        x[i] ~ Normal(a[i])<br>    end<br>end</pre></div></td><td><span class="wrong">wrong</td><td><span class="wrong">wrong</td><td>53.447</td><td>1.347</td><td>6.044</td><td>34.124</td><td>3.531</td><td><span class="error">error</td></tr>
<tr><td>dot_observe<div class="model-definition"><pre>@model function dot_observe(x=[1.5, 2.0, 2.5])<br>    a ~ Normal()<br>    x .~ Normal(a)<br>end</pre></div></td><td>2.883</td><td>2.381</td><td>28.530</td><td>1.757</td><td>9.651</td><td>56.920</td><td>5.581</td><td><span class="error">error</td></tr>
<tr><td>dynamic_constraint<div class="model-definition"><pre>@model function dynamic_constraint()<br>    a ~ Normal()<br>    b ~ truncated(Normal(); lower=a)<br>end</pre></div></td><td>2.456</td><td>2.521</td><td>36.018</td><td>1.361</td><td>7.643</td><td>30.066</td><td>2.692</td><td>1188.769</td></tr>
<tr><td>multiple_constraints_same_var<div class="model-definition"><pre>@model function multiple_constraints_same_var(<br>    ::Type{TV}=Vector{Float64}<br>) where {TV}<br>    x = TV(undef, 5)<br>    x[1] ~ Normal()<br>    x[2] ~ InverseGamma(2, 3)<br>    x[3] ~ truncated(Normal(), -5, 20)<br>    x[4:5] ~ Dirichlet([1.0, 2.0])<br>end</pre></div></td><td>4.946</td><td>26.264</td><td>60.254</td><td>1.229</td><td>13.671</td><td>20.125</td><td>2.251</td><td><span class="error">error</td></tr>
<tr><td>multithreaded<div class="model-definition"><pre>@model function multithreaded(x)<br>    a ~ Normal()<br>    Threads.@threads for i in eachindex(x)<br>        x[i] ~ Normal(a)<br>    end<br>end</pre></div></td><td>3.106</td><td>11.371</td><td>16.091</td><td>1.091</td><td><a class="issue" href="https://github.com/chalk-lab/Mooncake.jl/issues/570" target="_blank">(?)</a> <span class="error">error</td><td><span class="error">error</td><td><span class="wrong">wrong</td><td><span class="error">error</td></tr>
<tr><td>n010<div class="model-definition"><pre>@model function n010(::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, 10)<br>    for i in eachindex(a)<br>        a[i] ~ Normal()<br>    end<br>end</pre></div></td><td>4.494</td><td>2.080</td><td>139.955</td><td>1.695</td><td>4.400</td><td>23.143</td><td>2.534</td><td><span class="error">error</td></tr>
<tr><td>n050<div class="model-definition"><pre>@model function n050(::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, 50)<br>    for i in eachindex(a)<br>        a[i] ~ Normal()<br>    end<br>end</pre></div></td><td>18.506</td><td>2.349</td><td>630.821</td><td>10.141</td><td>3.960</td><td>24.773</td><td>2.381</td><td><span class="error">error</td></tr>
<tr><td>n100<div class="model-definition"><pre>@model function n100(::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, 100)<br>    for i in eachindex(a)<br>        a[i] ~ Normal()<br>    end<br>end</pre></div></td><td>36.913</td><td>2.614</td><td>1235.876</td><td>19.009</td><td>3.871</td><td>25.161</td><td>2.525</td><td><span class="error">error</td></tr>
<tr><td>n500<div class="model-definition"><pre>@model function n500(::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, 500)<br>    for i in eachindex(a)<br>        a[i] ~ Normal()<br>    end<br>end</pre></div></td><td>183.757</td><td>2.250</td><td>6556.945</td><td>57.562</td><td>4.283</td><td>22.671</td><td>2.265</td><td><span class="error">error</td></tr>
<tr><td>observe_index<div class="model-definition"><pre>@model function observe_index(x=[1.5, 2.0, 2.5])<br>    a ~ Normal()<br>    for i in eachindex(x)<br>        x[i] ~ Normal(a)<br>    end<br>end</pre></div></td><td>2.669</td><td>2.387</td><td>28.842</td><td>1.886</td><td>10.044</td><td>56.291</td><td>5.752</td><td><span class="error">error</td></tr>
<tr><td>observe_literal<div class="model-definition"><pre>@model function observe_literal()<br>    a ~ Normal()<br>    1.5 ~ Normal(a)<br>end</pre></div></td><td>2.817</td><td>3.209</td><td>27.353</td><td>1.524</td><td>9.087</td><td>34.054</td><td>3.526</td><td>1489.544</td></tr>
<tr><td>observe_multivariate<div class="model-definition"><pre>@model function observe_multivariate(x=[1.5, 2.0, 2.5], ::Type{TV}=Vector{Float64}) where {TV}<br>    a = TV(undef, length(x))<br>    a .~ Normal()<br>    x ~ MvNormal(a, I)<br>end</pre></div></td><td>2.714</td><td>3.465</td><td>50.314</td><td>1.346</td><td>6.214</td><td>26.972</td><td>2.679</td><td><span class="error">error</td></tr>
<tr><td>observe_submodel<div class="model-definition"><pre>@model function inner2(x, a)<br>    x ~ Normal(a)<br>end<br>@model function observe_submodel(x=1.5)<br>    a ~ Normal()<br>    _ignore ~ to_submodel(inner2(x, a))<br>end</pre></div></td><td>2.615</td><td>2.281</td><td>24.914</td><td>1.513</td><td>7.332</td><td>26.541</td><td>2.925</td><td>2121.632</td></tr>
<tr><td>pdb_eight_schools_centered<div class="model-definition"><pre>@model function pdb_eight_schools_centered(J, y, sigma)<br>    mu ~ Normal(0, 5)<br>    tau ~ truncated(Cauchy(0, 5); lower=0)<br>    theta = Vector{Float64}(undef, J)<br>    for i in 1:J<br>        theta[i] ~ Normal(mu, tau)<br>        y[i] ~ Normal(theta[i], sigma[i])<br>    end<br>end</pre></div></td><td>3.158</td><td>2.400</td><td>135.450</td><td>1.758</td><td>5.726</td><td>32.422</td><td>2.999</td><td><span class="error">error</td></tr>
<tr><td>pdb_eight_schools_noncentered<div class="model-definition"><pre>@model function pdb_eight_schools_noncentered(J, y, sigma)<br>    mu ~ Normal(0, 5)<br>    tau ~ truncated(Cauchy(0, 5); lower=0)<br>    theta_trans = Vector{Float64}(undef, J)<br>    for i in 1:J<br>        theta_trans[i] ~ Normal(0, 1)<br>        theta = theta_trans[i] * tau + mu;<br>        y[i] ~ Normal(theta, sigma[i])<br>    end<br>end</pre></div></td><td>4.188</td><td>2.299</td><td>134.222</td><td>1.777</td><td>6.435</td><td>34.062</td><td>3.018</td><td><span class="error">error</td></tr>
</tbody></table><h2>Manifest</h2><p>The tests above were run with the following package versions:</p><table id='manifest'><thead><tr><th>Package</th><th>Version</th><tr><td>ADTypes</td><td>v1.14.0</td></tr><tr><td>AbstractFFTs</td><td>v1.5.0</td></tr><tr><td>AbstractMCMC</td><td>v5.6.1</td></tr><tr><td>AbstractPPL</td><td>v0.11.0</td></tr><tr><td>AbstractTrees</td><td>v0.4.5</td></tr><tr><td>Accessors</td><td>v0.1.42</td></tr><tr><td>Adapt</td><td>v4.3.0</td></tr><tr><td>AliasTables</td><td>v1.1.3</td></tr><tr><td>ArgCheck</td><td>v2.5.0</td></tr><tr><td>ArgTools</td><td>v1.1.2</td></tr><tr><td>ArnoldiMethod</td><td>v0.4.0</td></tr><tr><td>Artifacts</td><td>v1.11.0</td></tr><tr><td>BangBang</td><td>v0.4.4</td></tr><tr><td>Base64</td><td>v1.11.0</td></tr><tr><td>Baselet</td><td>v0.1.1</td></tr><tr><td>Bijectors</td><td>v0.15.6</td></tr><tr><td>CEnum</td><td>v0.5.0</td></tr><tr><td>ChainRules</td><td>v1.72.3</td></tr><tr><td>ChainRulesCore</td><td>v1.25.1</td></tr><tr><td>Chairmarks</td><td>v1.3.1</td></tr><tr><td>ChangesOfVariables</td><td>v0.1.10</td></tr><tr><td>CommonSolve</td><td>v0.2.4</td></tr><tr><td>CommonSubexpressions</td><td>v0.3.1</td></tr><tr><td>Compat</td><td>v4.16.0</td></tr><tr><td>CompilerSupportLibraries_jll</td><td>v1.1.1+0</td></tr><tr><td>CompositionsBase</td><td>v0.1.2</td></tr><tr><td>ConsoleProgressMonitor</td><td>v0.1.2</td></tr><tr><td>ConstructionBase</td><td>v1.5.8</td></tr><tr><td>DataAPI</td><td>v1.16.0</td></tr><tr><td>DataStructures</td><td>v0.18.22</td></tr><tr><td>DataValueInterfaces</td><td>v1.0.0</td></tr><tr><td>Dates</td><td>v1.11.0</td></tr><tr><td>DefineSingletons</td><td>v0.1.2</td></tr><tr><td>DensityInterface</td><td>v0.4.0</td></tr><tr><td>DiffResults</td><td>v1.1.0</td></tr><tr><td>DiffRules</td><td>v1.15.1</td></tr><tr><td>DifferentiationInterface</td><td>v0.6.53</td></tr><tr><td>Distributed</td><td>v1.11.0</td></tr><tr><td>Distributions</td><td>v0.25.119</td></tr><tr><td>DocStringExtensions</td><td>v0.9.4</td></tr><tr><td>Downloads</td><td>v1.6.0</td></tr><tr><td>DynamicPPL</td><td>v0.36.2</td></tr><tr><td>Enzyme</td><td>v0.13.41</td></tr><tr><td>EnzymeCore</td><td>v0.8.8</td></tr><tr><td>Enzyme_jll</td><td>v0.0.175+0</td></tr><tr><td>ExprTools</td><td>v0.1.10</td></tr><tr><td>FileWatching</td><td>v1.11.0</td></tr><tr><td>FillArrays</td><td>v1.13.0</td></tr><tr><td>FiniteDifferences</td><td>v0.12.32</td></tr><tr><td>ForwardDiff</td><td>v0.10.38</td></tr><tr><td>FunctionWrappers</td><td>v1.1.3</td></tr><tr><td>Functors</td><td>v0.5.2</td></tr><tr><td>Future</td><td>v1.11.0</td></tr><tr><td>GPUArraysCore</td><td>v0.2.0</td></tr><tr><td>GPUCompiler</td><td>v1.4.0</td></tr><tr><td>Graphs</td><td>v1.12.1</td></tr><tr><td>HypergeometricFunctions</td><td>v0.3.28</td></tr><tr><td>IRTools</td><td>v0.4.14</td></tr><tr><td>Inflate</td><td>v0.1.5</td></tr><tr><td>InitialValues</td><td>v0.3.1</td></tr><tr><td>InteractiveUtils</td><td>v1.11.0</td></tr><tr><td>InverseFunctions</td><td>v0.1.17</td></tr><tr><td>IrrationalConstants</td><td>v0.2.4</td></tr><tr><td>IteratorInterfaceExtensions</td><td>v1.0.0</td></tr><tr><td>JLLWrappers</td><td>v1.7.0</td></tr><tr><td>JSON</td><td>v0.21.4</td></tr><tr><td>LLVM</td><td>v9.3.1</td></tr><tr><td>LLVMExtra_jll</td><td>v0.0.35+0</td></tr><tr><td>LazyArtifacts</td><td>v1.11.0</td></tr><tr><td>LeftChildRightSiblingTrees</td><td>v0.2.0</td></tr><tr><td>LibCURL</td><td>v0.6.4</td></tr><tr><td>LibCURL_jll</td><td>v8.6.0+0</td></tr><tr><td>LibGit2</td><td>v1.11.0</td></tr><tr><td>LibGit2_jll</td><td>v1.7.2+0</td></tr><tr><td>LibSSH2_jll</td><td>v1.11.0+1</td></tr><tr><td>LibTracyClient_jll</td><td>v0.9.1+6</td></tr><tr><td>Libdl</td><td>v1.11.0</td></tr><tr><td>LinearAlgebra</td><td>v1.11.0</td></tr><tr><td>LogDensityProblems</td><td>v2.1.2</td></tr><tr><td>LogExpFunctions</td><td>v0.3.29</td></tr><tr><td>Logging</td><td>v1.11.0</td></tr><tr><td>LoggingExtras</td><td>v1.1.0</td></tr><tr><td>MacroTools</td><td>v0.5.16</td></tr><tr><td>MappedArrays</td><td>v0.4.2</td></tr><tr><td>Markdown</td><td>v1.11.0</td></tr><tr><td>MbedTLS_jll</td><td>v2.28.6+0</td></tr><tr><td>MicroCollections</td><td>v0.2.0</td></tr><tr><td>Missings</td><td>v1.2.0</td></tr><tr><td>MistyClosures</td><td>v2.0.0</td></tr><tr><td>Mmap</td><td>v1.11.0</td></tr><tr><td>Mooncake</td><td>v0.4.118</td></tr><tr><td>MozillaCACerts_jll</td><td>v2023.12.12</td></tr><tr><td>NaNMath</td><td>v1.1.3</td></tr><tr><td>NetworkOptions</td><td>v1.2.0</td></tr><tr><td>ObjectFile</td><td>v0.4.4</td></tr><tr><td>OpenBLAS_jll</td><td>v0.3.27+1</td></tr><tr><td>OpenLibm_jll</td><td>v0.8.5+0</td></tr><tr><td>OpenSpecFun_jll</td><td>v0.5.6+0</td></tr><tr><td>OrderedCollections</td><td>v1.8.0</td></tr><tr><td>PDMats</td><td>v0.11.35</td></tr><tr><td>Parsers</td><td>v2.8.3</td></tr><tr><td>Pkg</td><td>v1.11.0</td></tr><tr><td>PrecompileTools</td><td>v1.2.1</td></tr><tr><td>Preferences</td><td>v1.4.3</td></tr><tr><td>Printf</td><td>v1.11.0</td></tr><tr><td>ProgressLogging</td><td>v0.1.4</td></tr><tr><td>ProgressMeter</td><td>v1.10.4</td></tr><tr><td>PtrArrays</td><td>v1.3.0</td></tr><tr><td>QuadGK</td><td>v2.11.2</td></tr><tr><td>Random</td><td>v1.11.0</td></tr><tr><td>RealDot</td><td>v0.1.0</td></tr><tr><td>Reexport</td><td>v1.2.2</td></tr><tr><td>Requires</td><td>v1.3.1</td></tr><tr><td>ReverseDiff</td><td>v1.16.1</td></tr><tr><td>Richardson</td><td>v1.4.2</td></tr><tr><td>Rmath</td><td>v0.8.0</td></tr><tr><td>Rmath_jll</td><td>v0.5.1+0</td></tr><tr><td>Roots</td><td>v2.2.7</td></tr><tr><td>SHA</td><td>v0.7.0</td></tr><tr><td>Scratch</td><td>v1.2.1</td></tr><tr><td>Serialization</td><td>v1.11.0</td></tr><tr><td>Setfield</td><td>v1.1.2</td></tr><tr><td>SharedArrays</td><td>v1.11.0</td></tr><tr><td>SimpleTraits</td><td>v0.9.4</td></tr><tr><td>Sockets</td><td>v1.11.0</td></tr><tr><td>SortingAlgorithms</td><td>v1.2.1</td></tr><tr><td>SparseArrays</td><td>v1.11.0</td></tr><tr><td>SparseInverseSubset</td><td>v0.1.2</td></tr><tr><td>SpecialFunctions</td><td>v2.5.1</td></tr><tr><td>SplittablesBase</td><td>v0.1.15</td></tr><tr><td>StaticArrays</td><td>v1.9.13</td></tr><tr><td>StaticArraysCore</td><td>v1.4.3</td></tr><tr><td>Statistics</td><td>v1.11.1</td></tr><tr><td>StatsAPI</td><td>v1.7.0</td></tr><tr><td>StatsBase</td><td>v0.34.5</td></tr><tr><td>StatsFuns</td><td>v1.5.0</td></tr><tr><td>StructArrays</td><td>v0.7.1</td></tr><tr><td>StructIO</td><td>v0.3.1</td></tr><tr><td>SuiteSparse</td><td></td></tr><tr><td>SuiteSparse_jll</td><td>v7.7.0+0</td></tr><tr><td>TOML</td><td>v1.0.3</td></tr><tr><td>TableTraits</td><td>v1.0.1</td></tr><tr><td>Tables</td><td>v1.12.0</td></tr><tr><td>Tar</td><td>v1.10.0</td></tr><tr><td>TerminalLoggers</td><td>v0.1.7</td></tr><tr><td>Test</td><td>v1.11.0</td></tr><tr><td>Tracy</td><td>v0.1.4</td></tr><tr><td>Transducers</td><td>v0.4.84</td></tr><tr><td>UUIDs</td><td>v1.11.0</td></tr><tr><td>Unicode</td><td>v1.11.0</td></tr><tr><td>Zlib_jll</td><td>v1.2.13+1</td></tr><tr><td>Zygote</td><td>v0.7.7</td></tr><tr><td>ZygoteRules</td><td>v0.2.7</td></tr><tr><td>libblastrampoline_jll</td><td>v5.11.0+0</td></tr><tr><td>nghttp2_jll</td><td>v1.59.0+0</td></tr><tr><td>p7zip_jll</td><td>v17.4.0+2</td></tr></table></main></body></html>