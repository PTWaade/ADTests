<!DOCTYPE html>
<html>
<head><title>Turing AD tests</title>
<link rel="stylesheet" type="text/css" href="main.css">
</head>
<body><main>
<h1>Turing AD tests</h1>

<p><a href="https://turinglang.org/docs">Turing.jl documentation</a> | <a href="https://github.com/TuringLang/Turing.jl">Turing.jl GitHub</a> | <a href="https://github.com/TuringLang/ADTests">Source code for these tests</a></p>

<p>This page is intended as a brief overview of how different AD backends
perform on a variety of Turing.jl models.
Note that the inclusion of any AD backend here does not imply an endorsement
from the Turing team; this table is purely for information.
</p>

<ul>
<li>The definitions of the models and AD types below can be found on <a
href="https://github.com/TuringLang/ADTests" target="_blank">GitHub</a>.</li>
<li><b>Numbers</b> indicate the time taken to calculate the gradient of the log
density of the model using the specified AD type, divided by the time taken to
calculate the log density itself (in AD speak, the primal). Basically:
<b>smaller means faster.</b></li>
<li>'<span class="wrong">wrong</span>' means that AD ran but the result was not
correct. If this happens you should be very wary! Note that this is done by
comparing against the result obtained using ForwardDiff, i.e., ForwardDiff is
by definition always 'correct'.</li>
<li>'<span class="error">error</span>' means that AD didn't run.</li>
<li>Some of the 'wrong' or 'error' entries have question marks next to them.
These will link to a GitHub issue or other page that describes the problem.
</ul>

<h2>Results</h2>
<table id="results"><thead><tr><th class="right">Model name \ AD type</th><th class="right">EnzymeForward</th><th class="right">EnzymeReverse</th><th class="right">FiniteDifferences</th><th class="right">ForwardDiff</th><th class="right">Mooncake</th><th class="right">ReverseDiff</th><th class="right">ReverseDiffCompiled</th><th class="right">Zygote</th></tr></thead><tbody>
<tr><td>assume_beta</td><td>2.388</td><td>4.378</td><td>26.310</td><td>1.702</td><td>8.187</td><td>16.832</td><td>2.029</td><td>590.948</td></tr>
<tr><td>assume_dirichlet</td><td>3.281</td><td>4.502</td><td><span class="wrong">wrong</td><td>1.519</td><td>2.228</td><td>27.585</td><td>3.139</td><td>640.947</td></tr>
<tr><td>assume_lkjcholu</td><td>16.765</td><td>7.637</td><td><span class="wrong">wrong</td><td>7.747</td><td>10.730</td><td>30.830</td><td>4.736</td><td><span class="error">error</td></tr>
<tr><td>assume_mvnormal</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>3.839</td><td>45.013</td><td>1.283</td><td>9.136</td><td>17.579</td><td>2.104</td><td>506.842</td></tr>
<tr><td>assume_normal</td><td>3.116</td><td>3.554</td><td>29.501</td><td>1.519</td><td>9.887</td><td>23.291</td><td>2.931</td><td>892.817</td></tr>
<tr><td>assume_submodel</td><td>2.880</td><td>4.012</td><td>32.933</td><td>1.165</td><td>6.683</td><td>7.827</td><td>1.150</td><td>695.846</td></tr>
<tr><td>assume_wishart</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>17.809</td><td><span class="error">error</td><td>1.104</td><td>10.362</td><td>29.639</td><td>3.514</td><td>314.036</td></tr>
<tr><td>control_flow</td><td>2.689</td><td>3.302</td><td>40.169</td><td>1.441</td><td>9.530</td><td>19.878</td><td><span class="wrong">wrong</td><td>996.625</td></tr>
<tr><td>dot_assume</td><td>3.128</td><td>2.405</td><td>84.822</td><td>1.389</td><td>6.472</td><td>30.692</td><td>3.207</td><td><span class="error">error</td></tr>
<tr><td>dot_assume_observe_index</td><td><span class="wrong">wrong</td><td><span class="wrong">wrong</td><td>40.321</td><td>1.487</td><td>7.089</td><td>45.362</td><td>4.720</td><td><span class="error">error</td></tr>
<tr><td>dot_observe</td><td>3.028</td><td>2.661</td><td>30.398</td><td>1.812</td><td>11.009</td><td>62.395</td><td>6.701</td><td><span class="error">error</td></tr>
<tr><td>dynamic_constraint</td><td>2.562</td><td>2.946</td><td>38.744</td><td>1.355</td><td>9.028</td><td>26.634</td><td>3.077</td><td>970.015</td></tr>
<tr><td>multiple_constraints_same_var</td><td>4.403</td><td>22.898</td><td><span class="wrong">wrong</td><td>1.267</td><td>17.635</td><td>19.166</td><td>1.855</td><td><span class="error">error</td></tr>
<tr><td>n010</td><td>3.910</td><td>2.194</td><td>149.409</td><td>1.811</td><td>5.534</td><td>34.271</td><td>3.349</td><td><span class="error">error</td></tr>
<tr><td>n050</td><td>20.859</td><td>2.877</td><td>437.717</td><td>12.978</td><td>5.154</td><td>37.230</td><td>3.838</td><td><span class="error">error</td></tr>
<tr><td>n100</td><td>41.220</td><td>2.766</td><td>1246.635</td><td>16.546</td><td>5.077</td><td>39.706</td><td>4.086</td><td><span class="error">error</td></tr>
<tr><td>n500</td><td>209.215</td><td>2.670</td><td>6878.065</td><td>59.059</td><td>4.936</td><td>33.801</td><td>3.449</td><td><span class="error">error</td></tr>
<tr><td>observe_index</td><td>2.936</td><td>2.412</td><td>31.155</td><td>1.798</td><td>10.049</td><td>63.147</td><td>6.803</td><td><span class="error">error</td></tr>
<tr><td>observe_literal</td><td>2.994</td><td>3.367</td><td>29.726</td><td>1.579</td><td>9.757</td><td>37.818</td><td>4.073</td><td>1225.547</td></tr>
<tr><td>observe_multivariate</td><td>2.769</td><td>4.479</td><td>54.451</td><td>1.353</td><td>7.178</td><td>33.094</td><td>3.536</td><td><span class="error">error</td></tr>
<tr><td>observe_submodel</td><td>2.907</td><td>4.662</td><td>19.180</td><td>1.289</td><td>8.228</td><td>14.950</td><td>1.445</td><td>870.481</td></tr>
</tbody></table><h2>Manifest</h2><p>The tests above were run with the following package versions:</p><table id='manifest'><thead><tr><th>Package</th><th>Version</th><tr><td>ADTypes</td><td>v1.14.0</td></tr><tr><td>AbstractFFTs</td><td>v1.5.0</td></tr><tr><td>AbstractMCMC</td><td>v5.6.0</td></tr><tr><td>AbstractPPL</td><td>v0.10.1</td></tr><tr><td>AbstractTrees</td><td>v0.4.5</td></tr><tr><td>Accessors</td><td>v0.1.42</td></tr><tr><td>Adapt</td><td>v4.3.0</td></tr><tr><td>AliasTables</td><td>v1.1.3</td></tr><tr><td>ArgCheck</td><td>v2.5.0</td></tr><tr><td>ArgTools</td><td>v1.1.2</td></tr><tr><td>ArnoldiMethod</td><td>v0.4.0</td></tr><tr><td>Artifacts</td><td>v1.11.0</td></tr><tr><td>BangBang</td><td>v0.4.4</td></tr><tr><td>Base64</td><td>v1.11.0</td></tr><tr><td>Baselet</td><td>v0.1.1</td></tr><tr><td>Bijectors</td><td>v0.15.6</td></tr><tr><td>CEnum</td><td>v0.5.0</td></tr><tr><td>ChainRules</td><td>v1.72.3</td></tr><tr><td>ChainRulesCore</td><td>v1.25.1</td></tr><tr><td>Chairmarks</td><td>v1.3.1</td></tr><tr><td>ChangesOfVariables</td><td>v0.1.9</td></tr><tr><td>CommonSolve</td><td>v0.2.4</td></tr><tr><td>CommonSubexpressions</td><td>v0.3.1</td></tr><tr><td>Compat</td><td>v4.16.0</td></tr><tr><td>CompilerSupportLibraries_jll</td><td>v1.1.1+0</td></tr><tr><td>CompositionsBase</td><td>v0.1.2</td></tr><tr><td>ConsoleProgressMonitor</td><td>v0.1.2</td></tr><tr><td>ConstructionBase</td><td>v1.5.8</td></tr><tr><td>DataAPI</td><td>v1.16.0</td></tr><tr><td>DataStructures</td><td>v0.18.22</td></tr><tr><td>DataValueInterfaces</td><td>v1.0.0</td></tr><tr><td>Dates</td><td>v1.11.0</td></tr><tr><td>DefineSingletons</td><td>v0.1.2</td></tr><tr><td>DensityInterface</td><td>v0.4.0</td></tr><tr><td>DiffResults</td><td>v1.1.0</td></tr><tr><td>DiffRules</td><td>v1.15.1</td></tr><tr><td>DifferentiationInterface</td><td>v0.6.52</td></tr><tr><td>Distributed</td><td>v1.11.0</td></tr><tr><td>Distributions</td><td>v0.25.119</td></tr><tr><td>DocStringExtensions</td><td>v0.9.4</td></tr><tr><td>Downloads</td><td>v1.6.0</td></tr><tr><td>DynamicPPL</td><td>v0.35.9</td></tr><tr><td>Enzyme</td><td>v0.13.38</td></tr><tr><td>EnzymeCore</td><td>v0.8.8</td></tr><tr><td>Enzyme_jll</td><td>v0.0.174+0</td></tr><tr><td>ExprTools</td><td>v0.1.10</td></tr><tr><td>FileWatching</td><td>v1.11.0</td></tr><tr><td>FillArrays</td><td>v1.13.0</td></tr><tr><td>FiniteDifferences</td><td>v0.12.32</td></tr><tr><td>ForwardDiff</td><td>v0.10.38</td></tr><tr><td>FunctionWrappers</td><td>v1.1.3</td></tr><tr><td>Functors</td><td>v0.5.2</td></tr><tr><td>Future</td><td>v1.11.0</td></tr><tr><td>GPUArraysCore</td><td>v0.2.0</td></tr><tr><td>GPUCompiler</td><td>v1.4.0</td></tr><tr><td>Graphs</td><td>v1.12.1</td></tr><tr><td>HypergeometricFunctions</td><td>v0.3.28</td></tr><tr><td>IRTools</td><td>v0.4.14</td></tr><tr><td>Inflate</td><td>v0.1.5</td></tr><tr><td>InitialValues</td><td>v0.3.1</td></tr><tr><td>InteractiveUtils</td><td>v1.11.0</td></tr><tr><td>InverseFunctions</td><td>v0.1.17</td></tr><tr><td>IrrationalConstants</td><td>v0.2.4</td></tr><tr><td>IteratorInterfaceExtensions</td><td>v1.0.0</td></tr><tr><td>JLLWrappers</td><td>v1.7.0</td></tr><tr><td>JSON</td><td>v0.21.4</td></tr><tr><td>LLVM</td><td>v9.3.1</td></tr><tr><td>LLVMExtra_jll</td><td>v0.0.35+0</td></tr><tr><td>LazyArtifacts</td><td>v1.11.0</td></tr><tr><td>LeftChildRightSiblingTrees</td><td>v0.2.0</td></tr><tr><td>LibCURL</td><td>v0.6.4</td></tr><tr><td>LibCURL_jll</td><td>v8.6.0+0</td></tr><tr><td>LibGit2</td><td>v1.11.0</td></tr><tr><td>LibGit2_jll</td><td>v1.7.2+0</td></tr><tr><td>LibSSH2_jll</td><td>v1.11.0+1</td></tr><tr><td>LibTracyClient_jll</td><td>v0.9.1+6</td></tr><tr><td>Libdl</td><td>v1.11.0</td></tr><tr><td>LinearAlgebra</td><td>v1.11.0</td></tr><tr><td>LogDensityProblems</td><td>v2.1.2</td></tr><tr><td>LogExpFunctions</td><td>v0.3.29</td></tr><tr><td>Logging</td><td>v1.11.0</td></tr><tr><td>LoggingExtras</td><td>v1.1.0</td></tr><tr><td>MacroTools</td><td>v0.5.16</td></tr><tr><td>MappedArrays</td><td>v0.4.2</td></tr><tr><td>Markdown</td><td>v1.11.0</td></tr><tr><td>MbedTLS_jll</td><td>v2.28.6+0</td></tr><tr><td>MicroCollections</td><td>v0.2.0</td></tr><tr><td>Missings</td><td>v1.2.0</td></tr><tr><td>MistyClosures</td><td>v2.0.0</td></tr><tr><td>Mmap</td><td>v1.11.0</td></tr><tr><td>Mooncake</td><td>v0.4.117</td></tr><tr><td>MozillaCACerts_jll</td><td>v2023.12.12</td></tr><tr><td>NaNMath</td><td>v1.1.3</td></tr><tr><td>NetworkOptions</td><td>v1.2.0</td></tr><tr><td>ObjectFile</td><td>v0.4.4</td></tr><tr><td>OpenBLAS_jll</td><td>v0.3.27+1</td></tr><tr><td>OpenLibm_jll</td><td>v0.8.5+0</td></tr><tr><td>OpenSpecFun_jll</td><td>v0.5.6+0</td></tr><tr><td>OrderedCollections</td><td>v1.8.0</td></tr><tr><td>PDMats</td><td>v0.11.34</td></tr><tr><td>Parsers</td><td>v2.8.3</td></tr><tr><td>Pkg</td><td>v1.11.0</td></tr><tr><td>PrecompileTools</td><td>v1.2.1</td></tr><tr><td>Preferences</td><td>v1.4.3</td></tr><tr><td>Printf</td><td>v1.11.0</td></tr><tr><td>ProgressLogging</td><td>v0.1.4</td></tr><tr><td>ProgressMeter</td><td>v1.10.4</td></tr><tr><td>PtrArrays</td><td>v1.3.0</td></tr><tr><td>QuadGK</td><td>v2.11.2</td></tr><tr><td>Random</td><td>v1.11.0</td></tr><tr><td>RealDot</td><td>v0.1.0</td></tr><tr><td>Reexport</td><td>v1.2.2</td></tr><tr><td>Requires</td><td>v1.3.1</td></tr><tr><td>ReverseDiff</td><td>v1.16.1</td></tr><tr><td>Richardson</td><td>v1.4.2</td></tr><tr><td>Rmath</td><td>v0.8.0</td></tr><tr><td>Rmath_jll</td><td>v0.5.1+0</td></tr><tr><td>Roots</td><td>v2.2.7</td></tr><tr><td>SHA</td><td>v0.7.0</td></tr><tr><td>Scratch</td><td>v1.2.1</td></tr><tr><td>Serialization</td><td>v1.11.0</td></tr><tr><td>Setfield</td><td>v1.1.2</td></tr><tr><td>SharedArrays</td><td>v1.11.0</td></tr><tr><td>SimpleTraits</td><td>v0.9.4</td></tr><tr><td>Sockets</td><td>v1.11.0</td></tr><tr><td>SortingAlgorithms</td><td>v1.2.1</td></tr><tr><td>SparseArrays</td><td>v1.11.0</td></tr><tr><td>SparseInverseSubset</td><td>v0.1.2</td></tr><tr><td>SpecialFunctions</td><td>v2.5.1</td></tr><tr><td>SplittablesBase</td><td>v0.1.15</td></tr><tr><td>StaticArrays</td><td>v1.9.13</td></tr><tr><td>StaticArraysCore</td><td>v1.4.3</td></tr><tr><td>Statistics</td><td>v1.11.1</td></tr><tr><td>StatsAPI</td><td>v1.7.0</td></tr><tr><td>StatsBase</td><td>v0.34.4</td></tr><tr><td>StatsFuns</td><td>v1.5.0</td></tr><tr><td>StructArrays</td><td>v0.7.1</td></tr><tr><td>StructIO</td><td>v0.3.1</td></tr><tr><td>SuiteSparse</td><td></td></tr><tr><td>SuiteSparse_jll</td><td>v7.7.0+0</td></tr><tr><td>TOML</td><td>v1.0.3</td></tr><tr><td>TableTraits</td><td>v1.0.1</td></tr><tr><td>Tables</td><td>v1.12.0</td></tr><tr><td>Tar</td><td>v1.10.0</td></tr><tr><td>TerminalLoggers</td><td>v0.1.7</td></tr><tr><td>Test</td><td>v1.11.0</td></tr><tr><td>Tracy</td><td>v0.1.4</td></tr><tr><td>Transducers</td><td>v0.4.84</td></tr><tr><td>UUIDs</td><td>v1.11.0</td></tr><tr><td>Unicode</td><td>v1.11.0</td></tr><tr><td>Zlib_jll</td><td>v1.2.13+1</td></tr><tr><td>Zygote</td><td>v0.7.6</td></tr><tr><td>ZygoteRules</td><td>v0.2.7</td></tr><tr><td>libblastrampoline_jll</td><td>v5.11.0+0</td></tr><tr><td>nghttp2_jll</td><td>v1.59.0+0</td></tr><tr><td>p7zip_jll</td><td>v17.4.0+2</td></tr></table></main></body></html>