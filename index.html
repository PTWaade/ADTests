<!DOCTYPE html>
<html>
<head><title>Turing AD tests</title>
<link rel="stylesheet" type="text/css" href="main.css">
</head>
<body><main>
<h1>Turing AD tests</h1>

<p><a href="https://turinglang.org/docs">Turing.jl documentation</a> | <a href="https://github.com/TuringLang/Turing.jl">Turing.jl GitHub</a> | <a href="https://github.com/TuringLang/ADTests">Source code for these tests</a></p>

<p>This page is intended as a brief overview of how different AD backends
perform on a variety of Turing.jl models.
Note that the inclusion of any AD backend here does not imply an endorsement
from the Turing team; this table is purely for information.
</p>

<ul>
<li>The definitions of the models and AD types below can be found on <a
href="https://github.com/TuringLang/ADTests" target="_blank">GitHub</a>.</li>
<li><b>Numbers</b> indicate the time taken to calculate the gradient of the log
density of the model using the specified AD type, divided by the time taken to
calculate the log density itself (in AD speak, the primal). Basically:
<b>smaller means faster.</b></li>
<li>'<span class="wrong">wrong</span>' means that AD ran but the result was not
correct. If this happens you should be very wary! Note that this is done by
comparing against the result obtained using ForwardDiff, i.e., ForwardDiff is
by definition always 'correct'.</li>
<li>'<span class="error">error</span>' means that AD didn't run.</li>
<li>Some of the 'wrong' or 'error' entries have question marks next to them.
These will link to a GitHub issue or other page that describes the problem.
</ul>

<h2>Results</h2>
<table id="results"><thead><tr><th>Model name \ AD type</th><th>EnzymeForward</th><th>EnzymeReverse</th><th>FiniteDifferences</th><th>ForwardDiff</th><th>Mooncake</th><th>ReverseDiff</th><th>ReverseDiffCompiled</th><th>Zygote</th></tr></thead><tbody>
<tr><td>assume_beta</td><td>2.515</td><td>3.188</td><td>25.495</td><td>1.723</td><td>8.350</td><td>18.085</td><td>2.012</td><td>613.651</td></tr>
<tr><td>assume_dirichlet</td><td>3.168</td><td>4.303</td><td><span class="wrong">wrong</td><td>1.520</td><td>11.878</td><td>27.491</td><td>3.133</td><td>656.857</td></tr>
<tr><td>assume_lkjcholu</td><td>17.482</td><td>7.884</td><td><span class="wrong">wrong</td><td>7.187</td><td>10.892</td><td>31.593</td><td>4.740</td><td><span class="error">error</td></tr>
<tr><td>assume_mvnormal</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>3.907</td><td>42.403</td><td>1.338</td><td>8.701</td><td>17.801</td><td>2.032</td><td>538.578</td></tr>
<tr><td>assume_normal</td><td>3.226</td><td>3.454</td><td>30.993</td><td>1.557</td><td>10.012</td><td>24.327</td><td>2.809</td><td>855.947</td></tr>
<tr><td>assume_submodel</td><td>2.994</td><td>4.035</td><td>32.382</td><td>1.164</td><td>8.772</td><td>11.071</td><td>1.144</td><td>721.971</td></tr>
<tr><td>assume_wishart</td><td><a class="issue" href="https://github.com/EnzymeAD/Enzyme.jl/issues/1995" target="_blank">(?)</a> <span class="error">error</td><td>17.093</td><td><span class="error">error</td><td>1.097</td><td>10.594</td><td>29.003</td><td>3.273</td><td>315.258</td></tr>
<tr><td>control_flow</td><td>2.726</td><td>3.300</td><td>40.550</td><td>1.446</td><td>9.372</td><td>21.015</td><td><span class="wrong">wrong</td><td>991.341</td></tr>
<tr><td>dot_assume</td><td>3.205</td><td>2.039</td><td>87.214</td><td>1.441</td><td>6.278</td><td>32.066</td><td>3.058</td><td><span class="error">error</td></tr>
<tr><td>dot_assume_observe_index</td><td><span class="wrong">wrong</td><td><span class="wrong">wrong</td><td>39.517</td><td>1.397</td><td>7.399</td><td>46.232</td><td>4.672</td><td><span class="error">error</td></tr>
<tr><td>dot_observe</td><td>2.987</td><td>2.497</td><td>30.293</td><td>1.824</td><td>10.883</td><td>65.138</td><td>6.200</td><td><span class="error">error</td></tr>
<tr><td>dynamic_constraint</td><td>2.596</td><td>2.868</td><td>39.465</td><td>0.191</td><td>9.033</td><td>26.772</td><td>3.176</td><td>963.028</td></tr>
<tr><td>multiple_constraints_same_var</td><td>4.339</td><td>22.996</td><td><span class="wrong">wrong</td><td>1.243</td><td>17.176</td><td>19.277</td><td>1.872</td><td><span class="error">error</td></tr>
<tr><td>n010</td><td>4.728</td><td>2.265</td><td>142.705</td><td>1.794</td><td>5.702</td><td>34.742</td><td>3.423</td><td><span class="error">error</td></tr>
<tr><td>n050</td><td>21.090</td><td>2.677</td><td>641.571</td><td>9.656</td><td>5.033</td><td>38.989</td><td>3.620</td><td><span class="error">error</td></tr>
<tr><td>n100</td><td>41.075</td><td>2.728</td><td>921.406</td><td>15.577</td><td>4.950</td><td>39.571</td><td>3.909</td><td><span class="error">error</td></tr>
<tr><td>n500</td><td>211.119</td><td>2.801</td><td>6633.621</td><td>58.315</td><td>4.912</td><td>34.003</td><td>3.590</td><td><span class="error">error</td></tr>
<tr><td>observe_index</td><td>2.777</td><td>2.389</td><td>31.291</td><td>1.783</td><td>10.350</td><td>61.927</td><td>6.477</td><td><span class="error">error</td></tr>
<tr><td>observe_literal</td><td>3.024</td><td>3.428</td><td>29.727</td><td>1.572</td><td>9.643</td><td>38.318</td><td>4.134</td><td>1213.576</td></tr>
<tr><td>observe_multivariate</td><td>2.949</td><td>3.789</td><td>56.255</td><td>1.381</td><td>7.145</td><td>31.231</td><td>3.455</td><td><span class="error">error</td></tr>
<tr><td>observe_submodel</td><td>2.878</td><td>4.601</td><td>19.116</td><td>1.310</td><td>8.269</td><td>14.259</td><td>1.421</td><td>841.852</td></tr>
</tbody></table></main></body></html>